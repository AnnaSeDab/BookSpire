{% extends "base.html" %}
{% block content %}

<h3>{{ book.title }}</h3>

<div class="grey lighten-2">
    <div class="row">
        <div class="col s12 m6 l4">
            <img class="cover" src="{{ book.cover }}">
        </div>
        <div class="col s12 m6 l2">
            <p>Author: {{ book.author }}</p>
            <p>Year of publication: {{ book.year_of_publication }}</p>
            <p>Score: {{ book.score }}</p>
        </div>
        <div class="col s12 m12 l6">
            <p>{{ book.synopsis }}</p>
        </div>
    </div>
</div>
<hr>
<div class="container center-align">
    <a href="{{ url_for('add_review', book_id=book.id) }}" class="waves-effect waves-light brown darken-4 white-text btn">Add review<i class="fa-sharp fa-solid fa-comment-plus"></i></a>
</div>
<hr>
<!-- rewiews -->
{% for review in reviews %}
    {% if review.book_id == book.id %}
    <div class="grey lighten-2">
        <div class="row">
            <div class="col s12">
                <p>{{ review.review_title }}</p>
            </div>
        </div>
        <div class="row">
            <div class="col s12">
                <p>{{ review.review_text }}</p>
            </div>
        </div>
        <div class="row">
            <div class="col left-align s6">
                {% if session.user|lower == review.username|lower %}
                <!-- Modal Trigger to delete book-->
                <a class="modal-trigger" href="#modaldeletereview"><i class="fa-solid fa-trash brown-text text-darken-4"></i></a>

                <!-- Modal Structure -->
                <div id="modaldeletereview" class="modal">
                    <div class="modal-content">
                    <h4>Are you sure you want to delete this review form the database?</h4>
                    <p>The review will be deleted permanently.</p>
                    </div>
                    <div class="modal-footer">
                    <a href="{{ url_for('delete_review', book_id=book.id, review_id=review.id) }}" class="modal-close waves-effect waves-green btn-flat">Delete review</a>
                    <a href="#!" class="modal-close waves-effect waves-light btn-flat">Let me think about it</a>
                    </div>
                </div>
                <a href="{{ url_for('edit_review', book_id=book.id, review_id=review.id) }}"><i class="fa-solid fa-pen-to-square  brown-text text-darken-4"></i></a>
                {% endif %}
            </div>
            <div class="col right-align s6 score-text">
                    {% if review.review_score == 1 %}
                        <i class="brown-text text-darken-4 fa-solid fa-thumbs-up"></i>
                    {% else %}
                        <i class="brown-text text-darken-4 fa-solid fa-thumbs-down"></i>
                    {% endif %}
            </div>        
        </div>
    </div>
    {% endif %}
{% endfor %}

{% endblock %}